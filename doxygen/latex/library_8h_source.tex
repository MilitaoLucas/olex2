\doxysection{library.\+h}
\hypertarget{library_8h_source}{}\label{library_8h_source}\index{sdl/library.h@{sdl/library.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/******************************************************************************}}
\DoxyCodeLine{00002\ \textcolor{comment}{*\ Copyright\ (c)\ 2004-\/2011\ O.\ Dolomanov,\ OlexSys\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{*\ This\ file\ is\ part\ of\ the\ OlexSys\ Development\ Framework.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00006\ \textcolor{comment}{*\ This\ source\ file\ is\ distributed\ under\ the\ terms\ of\ the\ licence\ located\ in\ \ \ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{*\ the\ root\ folder.\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00008\ \textcolor{comment}{******************************************************************************/}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ \_\_olx\_sdl\_library\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ \_\_olx\_sdl\_library\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}function.h"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#undef\ GetObject}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ BeginEsdlNamespace()}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ const\ uint16\_t}
\DoxyCodeLine{00018\ \ \ libReplace\ =\ 0x0001,}
\DoxyCodeLine{00019\ \ \ libReturn\ \ =\ 0x0002,}
\DoxyCodeLine{00020\ \ \ libChain\ \ \ =\ 0x0004;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ class\ TLibrary:\ public\ \mbox{\hyperlink{classIOlxObject}{IOlxObject}},\ public\ \mbox{\hyperlink{classABasicLibrary}{ABasicLibrary}}\ \ \{}
\DoxyCodeLine{00023\ \ \ \mbox{\hyperlink{classsorted_1_1StringAssociation}{sorted::StringAssociation<ABasicFunction*,\ true>}}\ Functions,\ Macros;}
\DoxyCodeLine{00024\ \ \ \mbox{\hyperlink{classTTypeList}{TTypeList<FunctionChainer>}}\ Chains;}
\DoxyCodeLine{00025\ \ \ olxstr\ LibraryName;}
\DoxyCodeLine{00026\ \ \ \mbox{\hyperlink{classolxstr__dict}{olxstr\_dict<TLibrary*,\ true>}}\ Libraries;}
\DoxyCodeLine{00027\ \ \ \mbox{\hyperlink{classALibraryContainer}{ALibraryContainer}}*\ LibraryOwner;}
\DoxyCodeLine{00028\ \ \ TLibrary*\ ParentLibrary;}
\DoxyCodeLine{00029\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00030\ \ \ \textcolor{comment}{/*\ these\ are\ the\ helper\ functions\ to\ find\ func/macro\ in\ this\ library\ only}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ \ using\ unqualified\ names}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ LocateFunction(\textcolor{keyword}{const}\ olxstr\&\ fuctionName,\ uint32\_t\ argc\ =\ 0);}
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ LocateMacro(\textcolor{keyword}{const}\ olxstr\&\ macroName,\ uint32\_t\ argc\ =\ 0);}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{keywordtype}{size\_t}\ LocateLocalFunctions(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordtype}{size\_t}\ LocateLocalMacros(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00038\ \ \ \textcolor{keywordtype}{void}\ SetParentLibrary(TLibrary*\ lib)\ \ \{\ \ ParentLibrary\ =\ lib;\ \ \}}
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{/*\ Adds\ a\ macro\ or\ a\ function\ to\ the\ given\ container.\ If\ an\ object\ with\ the}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ same\ name\ and\ number\ of\ arguments\ already\ exists\ and\ replace\ is\ set\ to\ false}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ the\ TDuplicateEntry\ exception\ will\ be\ thrown.\ Otherwise,\ if\ do\_return\ is}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ \ set\ to\ true,\ the\ duplicate\ object\ will\ be\ returned\ or\ deleted\ if\ it\ is\ set\ to}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ false.\ Note\ that\ if\ the\ description\ of\ the\ fm\ is\ empty\ -\/\ the\ description\ of}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ \ the\ previous\ function\ will\ be\ copied\ to}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}\ *Register(}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{classsorted_1_1StringAssociation}{sorted::StringAssociation<ABasicFunction*,\ true>}}\ \&container,}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ fm,}
\DoxyCodeLine{00049\ \ \ \ \ uint16\_t\ flags);}
\DoxyCodeLine{00050\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{/*\ it\ important\ to\ pass\ the\ owner\ for\ the\ special\ program\ state\ checks\ to\ be}}
\DoxyCodeLine{00052\ \textcolor{comment}{\ \ performed}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00054\ \ \ TLibrary(\textcolor{keyword}{const}\ olxstr\&\ libraryName,\ \mbox{\hyperlink{classALibraryContainer}{ALibraryContainer}}*\ owner\ =\ NULL);}
\DoxyCodeLine{00055\ \ \ \textcolor{keyword}{virtual}\ \string~TLibrary();}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keyword}{const}\ olxstr\&\ GetName()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ LibraryName;\ \ \}}
\DoxyCodeLine{00058\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classABasicLibrary}{ABasicLibrary}}*\ GetParentLibrary()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ ParentLibrary;\ \ \}}
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ implementation\ of\ the\ state\ checker}}
\DoxyCodeLine{00060\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ CheckProgramState(uint32\_t\ state);}
\DoxyCodeLine{00061\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classALibraryContainer}{ALibraryContainer}}*\ GetOwner()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ LibraryOwner;\ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{keywordtype}{size\_t}\ FunctionCount()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ Functions.Count();\ \}}
\DoxyCodeLine{00064\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ GetFunctionByIndex(\textcolor{keywordtype}{size\_t}\ i)\textcolor{keyword}{\ \ const\ }\{}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{return}\ Functions.GetValue(i);}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \textcolor{keywordtype}{size\_t}\ MacroCount()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ Macros.Count();\ \}}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ GetMacroByIndex(\textcolor{keywordtype}{size\_t}\ i)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{return}\ Macros.GetValue(i);}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ TLibrary*\ AddLibrary(\textcolor{keyword}{const}\ olxstr\&\ name,\ \mbox{\hyperlink{classALibraryContainer}{ALibraryContainer}}*\ owner\ =\ NULL);}
\DoxyCodeLine{00074\ \ \ \textcolor{comment}{//\ not\ that\ the\ library\ will\ be\ deleted\ upon\ destruction}}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordtype}{void}\ AttachLibrary(TLibrary*\ lib);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{size\_t}\ LibraryCount()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ Libraries.Count();\ \ \}}
\DoxyCodeLine{00078\ \ \ TLibrary*\ GetLibraryByName(\textcolor{keyword}{const}\ olxstr\&\ name)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{return}\ Libraries.Find(name,\ NULL);}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ \ \ TLibrary*\ GetLibraryByIndex(\textcolor{keywordtype}{size\_t}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordflow}{return}\ Libraries.GetValue(index);}
\DoxyCodeLine{00083\ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}\ *Register(}
\DoxyCodeLine{00086\ \ \ \ \ \mbox{\hyperlink{classAFunction}{AFunction}}*\ func,\ uint16\_t\ flags=0)}
\DoxyCodeLine{00087\ \ \ \{}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordflow}{return}\ Register(Functions,\ func,\ flags);}
\DoxyCodeLine{00089\ \ \ \}}
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}\ *Register(}
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{classAMacro}{AMacro}}*\ func,\ uint16\_t\ flags=0)}
\DoxyCodeLine{00092\ \ \ \{}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{return}\ Register(Macros,\ func,\ flags);}
\DoxyCodeLine{00094\ \ \ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \textcolor{comment}{/*\ if\ function\ name\ is\ no\ qualified,\ current\ lib\ is\ searched\ only,\ for}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ \ quailified\ function\ names\ like,\ html.home,\ the\ library\ will\ be\ located\ and}}
\DoxyCodeLine{00098\ \textcolor{comment}{\ \ searched}}
\DoxyCodeLine{00099\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ FindFunction(\textcolor{keyword}{const}\ olxstr\&\ name,\ uint32\_t\ argc\ =\ 0);}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{classABasicFunction}{ABasicFunction}}*\ FindMacro(\textcolor{keyword}{const}\ olxstr\&\ name,\ uint32\_t\ argc\ =\ 0);}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \textcolor{comment}{/*\ finds\ similar\ macros\ and\ puts\ them\ to\ the\ list,\ returns\ the\ number\ of}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ added\ entries}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordtype}{size\_t}\ FindSimilarMacros(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00107\ \ \ \textcolor{comment}{/*\ finds\ similar\ functions\ and\ puts\ them\ to\ the\ list,\ returns\ the\ number\ of}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ \ added\ entries}}
\DoxyCodeLine{00109\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{size\_t}\ FindSimilarFunctions(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00111\ \ \ \textcolor{comment}{/*\ finds\ similar\ library\ names\ and\ puts\ them\ to\ the\ list,\ returns\ the\ number}}
\DoxyCodeLine{00112\ \textcolor{comment}{\ \ of\ added\ entries}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{size\_t}\ FindSimilarLibraries(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicLibraryPList\&\ store);}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \textcolor{comment}{/*\ the\ functions\ do\ search\ sublibrraies\ too\ and\ return\ the\ list\ of\ available}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ functions\ the\ return\ value\ is\ the\ number\ of\ found\ functions}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{size\_t}\ LocateFunctions(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordtype}{size\_t}\ LocateMacros(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00121\ \ \ \textcolor{keywordtype}{size\_t}\ LocateSimilarFunctions(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{size\_t}\ LocateSimilarMacros(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{size\_t}\ LocateSimilarLibraries(\textcolor{keyword}{const}\ olxstr\&\ name,\ TBasicLibraryPList\&\ store);}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{keywordtype}{void}\ ListAllFunctions(TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{void}\ ListAllMacros(TBasicFunctionPList\&\ store);}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{bool}\ IsEmpty()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{if}(\ MacroCount()\ ==\ 0\ \&\&\ FunctionCount()\ ==\ 0\ )\ \ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\ \textcolor{keywordtype}{size\_t}\ i=0;\ i\ <\ LibraryCount();\ i++\ )}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ !GetLibraryByIndex(i)-\/>IsEmpty()\ )}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00136\ \ \ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \textcolor{keyword}{class\ }TDuplicateEntry\ :\ \textcolor{keyword}{public}\ TBasicException\ \ \{}
\DoxyCodeLine{00139\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00140\ \ \ \ \ TDuplicateEntry(\textcolor{keyword}{const}\ olxstr\&\ location,\ \textcolor{keyword}{const}\ olxstr\&\ entry,}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keyword}{const}\ olxstr\&\ entryType)\ :}
\DoxyCodeLine{00142\ \ \ \ \ \ \ TBasicException(location,\ olxstr(\textcolor{stringliteral}{"{}Duplicate\ "{}})\ <<\ entryType\ <<\ \textcolor{charliteral}{'-\/'}\ <<\ entry)}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classIOlxObject}{IOlxObject}}*\ Replicate()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ TDuplicateEntry(*\textcolor{keyword}{this});\ \ \}}
\DoxyCodeLine{00145\ \ \ \};}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \textcolor{keyword}{class\ }TLibraryNotFound\ :\ \textcolor{keyword}{public}\ TBasicException\ \ \{}
\DoxyCodeLine{00148\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00149\ \ \ \ \ TLibraryNotFound(\textcolor{keyword}{const}\ olxstr\&\ location,\ \textcolor{keyword}{const}\ olxstr\&\ libName)\ :}
\DoxyCodeLine{00150\ \ \ \ \ \ \ TBasicException(location,\ olxstr(\textcolor{stringliteral}{"{}Library\ "{}})\ <<\ libName\ <<\ \textcolor{stringliteral}{"{}\ not\ found"{}})}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \{\}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classIOlxObject}{IOlxObject}}*\ Replicate()\textcolor{keyword}{\ const\ }\{\ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ TLibraryNotFound(*\textcolor{keyword}{this});\ \ \}}
\DoxyCodeLine{00153\ \ \ \};}
\DoxyCodeLine{00154\ \};}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ EndEsdlNamespace()}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
